diff --git a/sites/all/modules/commerce_shipping/includes/commerce_shipping.checkout_pane.inc b/sites/all/modules/commerce_shipping/includes/commerce_shipping.checkout_pane.inc
index fed4752..925ab48 100644
--- a/sites/all/modules/commerce_shipping/includes/commerce_shipping.checkout_pane.inc
+++ b/sites/all/modules/commerce_shipping/includes/commerce_shipping.checkout_pane.inc
@@ -275,9 +275,12 @@ function commerce_shipping_recalculate_services_submit($form, &$form_state) {
         }
 
         // Unset any cached addressfield data for this customer profile.
-        foreach ($form_state['addressfield'] as $key => $value) {
-          if (strpos($key, 'commerce_customer_profile|' . $type) === 0) {
-            unset($form_state['addressfield'][$key]);
+        // Check if addressfield is set
+        if (isset($form_state['addressfield'])) {
+          foreach ($form_state['addressfield'] as $key => $value) {
+            if (strpos($key, 'commerce_customer_profile|' . $type) === 0) {
+              unset($form_state['addressfield'][$key]);
+            }
           }
         }
       }
